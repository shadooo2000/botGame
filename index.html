<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MONMATET GIGA ELITE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap');

        :root {
            --bg: #010206; --panel: rgba(13, 17, 30, 0.95); --primary: #00f2fe; --secondary: #7000ff;
            --success: #00ff88; --accent: #ff007a; --text: #ffffff;
            --border: rgba(255, 255, 255, 0.18);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text); min-height: 100vh; overflow-x: hidden; }
        
        /* –ñ–∏—Ä–Ω—ã–π —Ñ–æ–Ω */
        .bg-vfx { position: fixed; inset: 0; background: radial-gradient(circle at 10% 10%, var(--secondary), transparent 40%), radial-gradient(circle at 90% 90%, var(--primary), transparent 40%); opacity: 0.15; z-index: -1; }

        .wrapper { width: 100%; max-width: 440px; margin: 0 auto; padding: 20px; padding-bottom: 100px; }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .main-card { background: var(--panel); border: 2px solid var(--border); border-radius: 30px; padding: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.6); margin-bottom: 20px; }
        .bal-val { font-size: 2.5rem; font-weight: 900; letter-spacing: -1px; filter: drop-shadow(0 0 10px var(--primary)); }
        
        .xp-pill { background: rgba(0,0,0,0.5); border-radius: 50px; padding: 5px 15px; border: 1px solid var(--border); display: inline-flex; align-items: center; gap: 8px; margin-top: 10px; }
        .xp-line { width: 80px; height: 6px; background: #222; border-radius: 10px; overflow: hidden; }
        .xp-inner { height: 100%; background: linear-gradient(90deg, var(--primary), var(--secondary)); transition: 0.5s; }

        /* –õ–æ–±–±–∏ */
        .lobby-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .card-btn { 
            background: var(--panel); border: 1px solid var(--border); border-radius: 25px; 
            padding: 25px 15px; text-align: center; cursor: pointer; transition: 0.2s;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .card-btn:active { transform: scale(0.95); }
        .card-btn i { font-size: 2.5rem; display: block; margin-bottom: 10px; }

        .screen { display: none; animation: fadeIn 0.3s ease; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn-mega { 
            width: 100%; padding: 20px; border-radius: 20px; border: none; 
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: #000; font-weight: 900; font-size: 1.1rem; cursor: pointer;
            box-shadow: 0 10px 20px rgba(0, 242, 254, 0.2); text-transform: uppercase;
        }

        /* –ö—Ä–∞—à */
        .crash-stage { height: 240px; background: #000; border-radius: 30px; border: 2px solid #1e293b; position: relative; overflow: hidden; margin-bottom: 15px; }
        #rocket { position: absolute; font-size: 2.2rem; z-index: 10; display: none; width: 40px; height: 40px; text-align: center; line-height: 40px; filter: drop-shadow(0 0 10px var(--primary)); }
        
        /* –ö–æ—Å—Ç–∏ */
        .dice-wrap { display: flex; justify-content: space-around; padding: 15px 0; }
        .d-cube { width: 80px; height: 80px; background: #fff; border-radius: 18px; color: #000; font-size: 3rem; font-weight: 900; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .shaking { animation: shake 0.1s infinite; }
        @keyframes shake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -2px); } 100% { transform: translate(2px, -2px); } }

        /* –í–≤–æ–¥ */
        input { width: 100%; background: rgba(0,0,0,0.4); border: 2px solid var(--border); padding: 18px; border-radius: 18px; color: #fff; text-align: center; font-size: 1.4rem; font-weight: 900; margin-bottom: 15px; outline: none; }
        .back-nav { background: var(--panel); border: 1px solid var(--border); color: var(--text); padding: 10px 20px; border-radius: 15px; margin-bottom: 20px; cursor: pointer; font-weight: 700; }
        
        /* –î–æ–Ω–∞—Ç —Å–ø–∏—Å–æ–∫ */
        .don-item { background: rgba(255,255,255,0.03); padding: 15px; border-radius: 20px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border: 1px solid var(--border); }
    </style>
</head>
<body>
    <div class="bg-vfx"></div>
    <div class="wrapper">
        <header>
            <div class="main-card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                    <span style="font-weight:900; color:var(--primary); font-size: 0.9rem;">MONMATET ELITE</span>
                    <div id="m-status" style="color:var(--success); font-weight:900; font-size:0.75rem">‚ö° +0.0/s</div>
                </div>
                <div id="h-bal" class="bal-val">0</div>
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div class="xp-pill">
                        <small>L<span id="lvl">1</span></small>
                        <div class="xp-line"><div id="xp-fill" class="xp-inner"></div></div>
                    </div>
                    <div id="h-crys" style="color:var(--primary); font-weight:900; font-size: 1.1rem;">0 üíé</div>
                </div>
            </div>
        </header>

        <main id="lobby" class="screen active">
            <div class="lobby-grid">
                <div class="card-btn" onclick="nav('dice')"><i>üé≤</i><b>BATTLE</b></div>
                <div class="card-btn" onclick="nav('slots')"><i>üé∞</i><b>SLOTS</b></div>
                <div class="card-btn" onclick="nav('crash')" style="grid-column: span 2; display:flex; align-items:center; gap:20px; padding: 20px;">
                    <i style="margin:0">üöÄ</i><b>CRASH ROCKET</b>
                </div>
                <div class="card-btn" onclick="nav('mining')"><i>‚õèÔ∏è</i><b>MINING</b></div>
                <div class="card-btn" onclick="nav('profile')"><i>üé®</i><b>SHOP</b></div>
                <div class="card-btn" onclick="nav('exchange')" style="grid-column: span 2; background: linear-gradient(135deg, #1e1b4b, #312e81); border:none;">
                    <b>üí∞ –ö–£–ü–ò–¢–¨ –ú–û–ù–ï–¢–´</b>
                </div>
            </div>
        </main>

        <section id="dice" class="screen">
            <button class="back-nav" onclick="nav('lobby')">‚Üê –ù–ê–ó–ê–î</button>
            <div class="main-card" style="text-align:center">
                <div class="dice-wrap">
                    <div><small>–í–´</small><div id="d-p" class="d-cube">?</div></div>
                    <div style="align-self:center; font-weight:900; font-size:1.5rem; color:var(--accent)">VS</div>
                    <div><small>–ë–û–¢</small><div id="d-b" class="d-cube">?</div></div>
                </div>
                <div id="d-msg" style="height:25px; font-weight:900; margin:10px 0;"></div>
                <input type="number" id="d-bet" value="100">
                <button class="btn-mega" onclick="playDiceBattle()">–ò–ì–†–ê–¢–¨</button>
            </div>
        </section>

        <section id="crash" class="screen">
            <button class="back-nav" onclick="nav('lobby')">‚Üê –ù–ê–ó–ê–î</button>
            <div class="crash-stage">
                <div id="c-m" style="position:absolute; width:100%; text-align:center; top:50px; font-size:3.5rem; font-weight:900; z-index:5;">1.00x</div>
                <div id="rocket">üöÄ</div>
                <canvas id="c-cv" style="width:100%; height:100%"></canvas>
            </div>
            <input type="number" id="c-bet" value="10">
            <button id="c-btn" class="btn-mega" onclick="handleCrash()">–í–ó–õ–ï–¢</button>
        </section>

        <section id="slots" class="screen">
            <button class="back-nav" onclick="nav('lobby')">‚Üê –ù–ê–ó–ê–î</button>
            <div class="main-card" style="background:#000;">
                <div style="display:flex; justify-content:center; gap:10px; margin-bottom:20px;">
                    <div class="d-cube" id="s1">üíé</div>
                    <div class="d-cube" id="s2">üíé</div>
                    <div class="d-cube" id="s3">üíé</div>
                </div>
                <input type="number" id="s-bet" value="50">
                <button class="btn-mega" onclick="playSlots()">SPIN</button>
            </div>
        </section>

        <section id="exchange" class="screen">
            <button class="back-nav" onclick="nav('lobby')">‚Üê –ù–ê–ó–ê–î</button>
            <div class="main-card">
                <h3 style="text-align:center; margin-bottom:15px;">CRYPTO DONATE</h3>
                <div class="don-item"><div><b>1,000 –ú–û–ù–ï–¢</b><br><small>–¶–µ–Ω–∞: 2$</small></div><button class="btn-mega" style="width:auto; padding:8px 15px; margin:0" onclick="buyCoins(1000, 2)">BUY</button></div>
                <div class="don-item"><div><b>3,000 –ú–û–ù–ï–¢</b><br><small>–¶–µ–Ω–∞: 5$</small></div><button class="btn-mega" style="width:auto; padding:8px 15px; margin:0" onclick="buyCoins(3000, 5)">BUY</button></div>
                <div class="don-item"><div><b>5,000 –ú–û–ù–ï–¢</b><br><small>–¶–µ–Ω–∞: 7$</small></div><button class="btn-mega" style="width:auto; padding:8px 15px; margin:0" onclick="buyCoins(5000, 7)">BUY</button></div>
                <div class="don-item"><div><b>10,000 –ú–û–ù–ï–¢</b><br><small>–¶–µ–Ω–∞: 10$</small></div><button class="btn-mega" style="width:auto; padding:8px 15px; margin:0" onclick="buyCoins(10000, 10)">BUY</button></div>
            </div>
        </section>

        <section id="mining" class="screen"><button class="back-nav" onclick="nav('lobby')">‚Üê –ù–ê–ó–ê–î</button><div id="m-list"></div></section>
        <section id="profile" class="screen"><button class="back-nav" onclick="nav('lobby')">‚Üê –ù–ê–ó–ê–î</button><div id="t-list"></div></section>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let state = JSON.parse(localStorage.getItem('mon_elite_final')) || {
            bal: 1000, crys: 0, xp: 0, lvl: 1, miners: [0, 0]
        };

        const minersData = [{ n: 'RTX 3060 CORE', p: 1500, r: 0.5 }, { n: 'RTX 4090 ULTRA', p: 10000, r: 5.0 }];

        function save() {
            localStorage.setItem('mon_elite_final', JSON.stringify(state));
            document.getElementById('h-bal').innerText = Math.floor(state.bal).toLocaleString();
            document.getElementById('h-crys').innerText = state.crys + " üíé";
            document.getElementById('lvl').innerText = state.lvl;
            let nXp = state.lvl * 1000;
            document.getElementById('xp-fill').style.width = (state.xp / nXp * 100) + '%';
            renderMining();
        }

        function nav(id) { 
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); 
            document.getElementById(id).classList.add('active'); 
        }

        // –î–û–ù–ê–¢
        function buyCoins(coins, usd) {
            tg.sendData(JSON.stringify({ action: "deposit", amount_usd: usd, coins_to_add: coins }));
            tg.close();
        }

        // –ö–†–ê–® (–ü–õ–ê–í–ù–´–ô –ò –ö–†–ê–°–ò–í–´–ô)
        let crA = false, crM = 1.0, crT, crP = [];
        function handleCrash() {
            let b = +document.getElementById('c-bet').value;
            const rk = document.getElementById('rocket'), cv = document.getElementById('c-cv'), ctx = cv.getContext('2d');
            if(!crA) {
                if(b > state.bal) return;
                crA = true; state.bal -= b; crM = 1.0; crP = []; rk.style.display = 'block';
                let boom = 1.1 + Math.random() * 6;
                cv.width = cv.offsetWidth; cv.height = cv.offsetHeight;
                crT = setInterval(() => {
                    crM += crM * 0.015; crP.push(crM);
                    document.getElementById('c-m').innerText = crM.toFixed(2)+'x';
                    ctx.clearRect(0,0,cv.width,cv.height);
                    ctx.beginPath(); ctx.strokeStyle = "#00f2fe"; ctx.lineWidth = 6; ctx.lineCap = "round";
                    ctx.moveTo(0, cv.height);
                    let lx = 0, ly = cv.height;
                    crP.forEach((p, i) => {
                        let x = (i / (crP.length + 20)) * cv.width;
                        let y = cv.height - (Math.pow(p, 1.4) * 12);
                        ctx.lineTo(x, y);
                        if(i === crP.length-1) {
                            let ang = Math.atan2(y - ly, x - lx) * (180 / Math.PI);
                            rk.style.left = x + 'px'; rk.style.top = y + 'px';
                            rk.style.transform = `translate(-50%, -50%) rotate(${ang + 45}deg)`;
                        }
                        lx = x; ly = y;
                    });
                    ctx.stroke();
                    if(crM >= boom) { 
                        clearInterval(crT); crA=false; rk.style.display='none'; 
                        document.getElementById('c-m').innerText="BOOM!"; save(); 
                    }
                }, 50);
            } else { 
                clearInterval(crT); crA=false; state.bal += b*crM; rk.style.display='none'; 
                state.xp += b*0.1; checkLvl(); save(); 
            }
        }

        // –ö–û–°–¢–ò
        function playDiceBattle() {
            let b = +document.getElementById('d-bet').value; if(b > state.bal || b <= 0) return;
            const pC = document.getElementById('d-p'), bC = document.getElementById('d-b'), msg = document.getElementById('d-msg');
            pC.classList.add('shaking'); bC.classList.add('shaking');
            setTimeout(() => {
                pC.classList.remove('shaking'); let p = Math.floor(Math.random()*6)+1; pC.innerText = p;
                setTimeout(() => {
                    bC.classList.remove('shaking'); let bo = Math.floor(Math.random()*6)+1; bC.innerText = bo;
                    if(p > bo) { state.bal += b; msg.innerText="–ü–û–ë–ï–î–ê!"; msg.style.color="var(--success)"; }
                    else if(p < bo) { state.bal -= b; msg.innerText="–ü–†–û–ò–ì–†–´–®!"; msg.style.color="var(--accent)"; }
                    else { msg.innerText="–ù–ò–ß–¨–Ø!"; }
                    state.xp += b*0.1; checkLvl(); save();
                }, 600);
            }, 600);
        }

        // –°–õ–û–¢–´
        function playSlots() {
            let b = +document.getElementById('s-bet').value; if(b > state.bal || b <= 0) return;
            state.bal -= b;
            const syms = ['üíé','üçí','7Ô∏è‚É£','üçã','üîî','üçâ'];
            const r = [0,0,0].map(() => syms[Math.floor(Math.random()*syms.length)]);
            [1,2,3].forEach(i => document.getElementById('s'+i).innerText = r[i-1]);
            if(r[0]==r[1] || r[1]==r[2] || r[0]==r[2]) state.bal += b*2;
            state.xp += b*0.1; checkLvl(); save();
        }

        function checkLvl() { if(state.xp >= state.lvl*1000) { state.xp=0; state.lvl++; } }
        
        function renderMining() {
            document.getElementById('m-list').innerHTML = minersData.map((m, i) => `
                <div class="main-card" style="display:flex; justify-content:space-between; align-items:center;">
                    <div><b>${m.n}</b><br><small>+${m.r}/s</small></div>
                    <button class="btn-mega" style="width:auto; padding:10px;" onclick="buyMiner(${i})">${Math.floor(m.p*Math.pow(1.3, state.miners[i]))} üí∞</button>
                </div>
            `).join('');
        }
        function buyMiner(i) {
            let pr = Math.floor(minersData[i].p * Math.pow(1.3, state.miners[i]));
            if(state.bal >= pr) { state.bal -= pr; state.miners[i]++; save(); }
        }

        setInterval(() => { 
            let r = (state.miners[0]*0.5) + (state.miners[1]*5.0); 
            if(r>0){ state.bal += r/10; save(); }
            document.getElementById('m-status').innerText = `‚ö° +${r.toFixed(1)}/s`;
        }, 100);

        save();
    </script>
</body>
</html>